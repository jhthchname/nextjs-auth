(()=>{var e={};e.id=405,e.ids=[405,660],e.modules={806:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{w:()=>i});var a=r(9648),o=e([a]);a=(o.then?(await o)():o)[0];let n=()=>({redirect:{destination:"/login",permanent:!1}}),i=async e=>{let t=e?.cookies?.token?.toString().length>0?e?.cookies?.token?.replace("j:",""):null;if(!t)return n();try{let e=await a.default.post("http://localhost:3000/api/user/check-token",{},{headers:{Authorization:`Bearer ${t}`}});return{props:{user:e?.data}}}catch(e){return n()}};s()}catch(e){s(e)}})},1838:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>i}),r(6689);var a=r(7927),o=r(997),n=e([a]);a=(n.then?(await n)():n)[0];let i=function({children:e,user:t}){return(0,o.jsxs)("div",{className:"flex flex-col min-h-screen",children:[o.jsx(a.Z,{user:t}),e]})};s()}catch(e){s(e)}})},7927:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>p});var a=r(6689),o=r(1664),n=r.n(o),i=r(5675),l=r.n(i),c=r(9648),u=r(1163),d=r(997),m=e([c]);function p({user:e}){let t=(0,u.useRouter)(),r=async()=>{try{let r=await c.default.post("/api/auth/signout",{},{headers:{Authorization:`Bearer ${e?.token}`}});r?.data?._id&&t.push("/login")}catch(e){console.log("error signout=========>",e)}},{0:s,1:o}=(0,a.useState)(!1);return(0,d.jsxs)("nav",{className:"bg-white p-4 border-b border-[#d6cffe]",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[d.jsx(n(),{href:"/",children:d.jsx(l(),{src:"../public/jhinthicha.svg",width:100,height:100,alt:"logo"})}),d.jsx("div",{className:"md:hidden",children:d.jsx("button",{id:"menu",className:"text-[#6e59e7]",onClick:()=>{o(!s)},children:d.jsx("svg",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",className:"w-6 h-6",children:d.jsx("path",{d:"M4 6h16M4 12h16M4 18h16"})})})}),d.jsx("ul",{className:"hidden md:flex items-center space-x-4",children:e?._id?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("li",{className:"relative group",children:[d.jsx(n(),{href:"/",className:"text-[#6e59e7] text-lg font-normal my-2",children:"Request Form"}),d.jsx("span",{className:"absolute -bottom-1 left-1/2 w-0 transition-all h-[2px] bg-[#816def] group-hover:w-1/2"}),d.jsx("span",{className:"absolute -bottom-1 right-1/2 w-0 transition-all h-[2px] bg-[#816def] group-hover:w-1/2"})]}),(0,d.jsxs)("li",{className:"relative group",children:[d.jsx(n(),{href:"/requestmanagement",className:"text-[#6e59e7] text-lg font-normal my-2",children:"Request Management"}),d.jsx("span",{className:"absolute -bottom-1 left-1/2 w-0 transition-all h-[2px] bg-[#816def] group-hover:w-1/2"}),d.jsx("span",{className:"absolute -bottom-1 right-1/2 w-0 transition-all h-[2px] bg-[#816def] group-hover:w-1/2"})]}),(0,d.jsxs)("li",{className:"relative group",children:[d.jsx(n(),{href:"/usermanagement",className:"text-[#6e59e7] text-lg font-normal my-2",children:"User Management"}),d.jsx("span",{className:"absolute -bottom-1 left-1/2 w-0 transition-all h-[2px] bg-[#816def] group-hover:w-1/2"}),d.jsx("span",{className:"absolute -bottom-1 right-1/2 w-0 transition-all h-[2px] bg-[#816def] group-hover:w-1/2"})]}),d.jsx("li",{className:"w-5"}),d.jsx("li",{className:"relative",children:d.jsx("button",{className:"relative flex h-[40px] w-[80px] items-center justify-center overflow-hidden bg-[#816def] font-medium text-white transition-all duration-300 before:absolute before:inset-0 before:border-0 before:border-white before:duration-100 before:ease-linear hover:bg-white hover:text-[#6e59e7] hover:before:border-[25px]",onClick:r,children:d.jsx("span",{className:"relative z-10",children:"Logout"})})})]}):null})]}),s?d.jsx("ul",{className:"flex-col md:hidden",children:e?._id?(0,d.jsxs)(d.Fragment,{children:[d.jsx("li",{className:"py-3 ",children:d.jsx(n(),{href:"/",className:"text-[#6e59e7] text-lg font-normal my-2 active:text-[#5d47da]",children:"Request Form"})}),d.jsx("li",{className:"py-3",children:d.jsx(n(),{href:"/requestmanagement",className:"text-[#6e59e7] text-lg font-normal my-2 active:text-[#5d47da]",children:"Request Management"})}),d.jsx("li",{className:"py-3",children:d.jsx(n(),{href:"/usermanagement",className:"text-[#6e59e7] text-lg font-normal my-2 active:text-[#5d47da]",children:"User Management"})}),d.jsx("li",{className:"w-5"}),d.jsx("li",{className:"py-3",children:d.jsx("button",{className:"relative flex h-[40px] w-[80px] items-center justify-center overflow-hidden bg-[#816def] font-medium text-white transition-all duration-300 before:absolute before:inset-0 before:border-0 before:border-white before:duration-100 before:ease-linear hover:bg-white hover:text-[#6e59e7] hover:before:border-[25px]",onClick:r,children:d.jsx("span",{className:"relative z-10",children:"Logout"})})})]}):null}):null]})}c=(m.then?(await m)():m)[0],s()}catch(e){s(e)}})},728:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{i:()=>i});var a=r(6689),o=r(6201),n=e([o]);o=(n.then?(await n)():n)[0];let i=()=>{let{0:e,1:t}=(0,a.useState)(!1),r=(0,a.useCallback)((r,s="success")=>{"success"===s?e||(o.default.success(r),t(!0)):"error"===s?o.default.error(r):(0,o.default)(r)},[e]),s=(0,a.useCallback)(()=>{t(!1)},[]);return{showToast:r,resetSuccessToast:s}};s()}catch(e){s(e)}})},5813:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l}),r(6689),r(108),r(9107),r(5001);var s=r(5725);let a=require("antd/lib/locale/en_US");var o=r.n(a),n=r(997);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function l({Component:e,pageProps:t}){return(e.getLayout??(e=>e))(n.jsx(s.ConfigProvider,{locale:o(),children:n.jsx(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t))}))}},670:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>x,getServerSideProps:()=>f});var a=r(6689),o=r(1838),n=r(9332),i=r(6201),l=r(806),c=r(728),u=r(9648),d=r(997),m=e([o,i,l,c,u]);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){var s,a;s=t,a=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=typeof s)return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s))in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}async function f({req:e}){return await (0,l.w)(e)}function x(e){let t=(0,n.useRouter)(),{0:r,1:s}=(0,a.useState)({query:"",skip:0,limit:10}),{0:l,1:m}=(0,a.useState)([]),p=(0,n.useSearchParams)(),{showToast:f,resetSuccessToast:x}=(0,c.i)(),{0:g,1:b}=(0,a.useState)({title:"",type:"",detail:""}),{0:y,1:j}=(0,a.useState)([]);(0,a.useEffect)(()=>{let r=p.get("auth");console.log("authStatus:",r),console.log("Current token:",e?.user?.token),r||console.log("No authStatus in URL"),"login"===r&&(f("Login success!"),t.replace("/",void 0,{shallow:!0})),v(),w()},[p,t,f,x]);let v=async()=>{try{let t=await u.default.get("/api/user",{headers:{Authorization:`Bearer ${e?.user?.token}`},params:r});t?.data?.total>0?m(t?.data):m([])}catch(e){console.log("error query data user=========>",e)}},w=async()=>{try{let t=await u.default.get("/api/type-form",{headers:{Authorization:`Bearer ${e?.user?.token}`}});t.data.results&&j(t.data.results)}catch(e){console.error("Error fetching request types:",e),f("ไม่สามารถดึงข้อมูลประเภทคำขอได้","error")}},N=e=>{let{id:t,value:r}=e.target;b(e=>h(h({},e),{},{[t]:r}))},S=()=>{b({title:"",type:"",detail:""})},P=async t=>{t.preventDefault();let{title:r,type:s,detail:a}=g;if(!g.title||!g.type||!g.detail){f("กรุณากรอกข้อมูลให้ครบทุกช่อง","error");return}if(r&&s&&a)try{let t=await (0,u.default)({method:"POST",url:"/api/form/create",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e?.user?.token}`},data:JSON.stringify(g)});t?.data?._id?(f("ส่งคำขอสำเร็จ","success"),S(),x()):f("ส่งคำขอไม่สำเร็จ กรุณาตรวจสอบข้อมูลและลองอีกครั้ง","error")}catch(e){console.error("Send request error",e),e.response?401===e.response.status?f("Token ไม่ถูกต้องหรือหมดอายุ กรุณาเข้าสู่ระบบใหม่","error"):f(`เกิดข้อผิดพลาดจากเซิร์ฟเวอร์: ${e.response.data.message||e.response.statusText}`,"error"):e.request?f("ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้","error"):(console.error("Error message:",e.message),f("เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง","error"))}};return(0,d.jsxs)(o.Z,{user:e?.user,children:[d.jsx(i.Toaster,{position:"top-right",toastOptions:{duration:3e3}}),d.jsx("section",{className:"bg-white",children:(0,d.jsxs)("div",{className:"py-8 lg:py-16 px-4 mx-auto max-w-screen-md",children:[d.jsx("h2",{className:"mb-6 text-4xl tracking-tight font-extrabold text-center bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent",children:"Request Form"}),d.jsx("p",{className:"mb-8 lg:mb-16 font-light text-center text-black sm:text-xl",children:"ยินดีต้อนรับสู่ระบบยื่นคำขอ กรุณากรอกรายละเอียดให้ครบถ้วน"}),(0,d.jsxs)("form",{onSubmit:P,className:"space-y-8",children:[(0,d.jsxs)("div",{children:[d.jsx("label",{htmlFor:"title",className:"block mb-2 text-sm font-medium text-gray-900",children:"ชื่อเรื่อง"}),d.jsx("input",{type:"text",id:"title",value:g.title,onChange:N,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:outline-none focus:border-[#6e59e7] focus:ring-[#806aff] focus:ring-1 block w-full p-2.5",placeholder:"ระบุชื่อเรื่องที่ต้องการยื่นตำขอ",required:!0})]}),(0,d.jsxs)("div",{children:[d.jsx("label",{htmlFor:"type",className:"block mb-2 text-sm font-medium text-gray-900",children:"ประเภท"}),(0,d.jsxs)("select",{id:"type",value:g.type,onChange:N,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:outline-none focus:border-[#6e59e7] focus:ring-[#806aff] focus:ring-1 block w-full p-2.5",children:[d.jsx("option",{value:"",children:"เลือกประเภทคำขอ"}),y.map(e=>d.jsx("option",{value:e.name,children:e.name},e._id))]})]}),(0,d.jsxs)("div",{className:"sm:col-span-2",children:[d.jsx("label",{htmlFor:"detail",className:"block mb-2 text-sm font-medium text-gray-900",children:"รายละเอียด"}),d.jsx("textarea",{id:"detail",rows:"6",value:g.detail,onChange:N,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:outline-none focus:border-[#6e59e7] focus:ring-[#806aff] focus:ring-1 block w-full p-2.5",placeholder:"อธิบายรายละเอียดเพิ่มเติม"})]}),(0,d.jsxs)("div",{className:"flex space-x-4",children:[d.jsx("button",{type:"submit",className:"py-3 px-6 text-sm font-medium text-center text-white rounded-lg bg-[#806aff] sm:w-fit hover:bg-[#6e59e7] focus:ring-4 focus:outline-none focus:ring-[#9f90f7]",children:"ส่งคำขอ"}),d.jsx("button",{type:"button",onClick:S,className:"py-3 px-6 text-sm font-medium text-center text-white rounded-lg bg-gray-400 sm:w-fit hover:bg-gray-500 focus:ring-4 focus:outline-none focus:ring-gray-300",children:"รีเซ็ต"})]})]})]})})]})}[o,i,l,c,u]=m.then?(await m)():m,s()}catch(e){s(e)}})},5001:(e,t,r)=>{var s=r(2681)(!1);s.push([e.id,"",""]),e.exports=s},8270:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>x,default:()=>m,getServerSideProps:()=>f,getStaticPaths:()=>h,getStaticProps:()=>p,reportWebVitals:()=>g,routeModule:()=>N,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>j,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>b});var a=r(7093),o=r(5244),n=r(1323),i=r(5056),l=r.n(i),c=r(5813),u=r(670),d=e([u]);u=(d.then?(await d)():d)[0];let m=(0,n.l)(u,"default"),p=(0,n.l)(u,"getStaticProps"),h=(0,n.l)(u,"getStaticPaths"),f=(0,n.l)(u,"getServerSideProps"),x=(0,n.l)(u,"config"),g=(0,n.l)(u,"reportWebVitals"),b=(0,n.l)(u,"unstable_getStaticProps"),y=(0,n.l)(u,"unstable_getStaticPaths"),j=(0,n.l)(u,"unstable_getStaticParams"),v=(0,n.l)(u,"unstable_getServerProps"),w=(0,n.l)(u,"unstable_getServerSideProps"),N=new a.PagesRouteModule({definition:{kind:o.x.PAGES,page:"/index",pathname:"/",bundlePath:"",filename:""},components:{App:c.default,Document:l()},userland:u});s()}catch(e){s(e)}})},108:()=>{},5725:e=>{"use strict";e.exports=require("antd")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},9648:e=>{"use strict";e.exports=import("axios")},6201:e=>{"use strict";e.exports=import("react-hot-toast")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[56,468,664,163,675,332],()=>r(8270));module.exports=s})();